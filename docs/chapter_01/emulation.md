# 从基因组数据模拟短序列数据

对于分析软件进行效率或准确性评估时，需要用数据进行评估。我们可以用实测数据进行评估，也可以使用软件模拟测序数据。

## 1. wgsim

[wgsim](https://github.com/lh3/wgsim) 就是这样一个软件，它是由大牛 Li heng 开发的基因组转成短序列的软件。

### 1.1 安装软件

```
# 克隆代码到本地，编译安装
$ git clone https://github.com/lh3/wgsim.git && cd wgsim
$ gcc -g -O2 -Wall -o wgsim wgsim.c -lz -lm
$ sudo ln -s `pwd`/wgsim /usr/local/sbin
```

### 1.2 模拟基因组短序列数据

使用所有参数为默认值，将大肠杆菌基因组数据转换为 PE250 fastq 格式数据。

```
# 下载 E. coli 基因组核酸数据
$ wget https://raw.github.com/ecerami/samtools_primer/master/tutorial/genomes/NC_008253.fna

# wgsim 模拟生成 PE250 数据，分为产生 reads_1 和 reads_2 2个文件
$ wgsim -S11 -1250 -2250 NC_008253.fna reads_1.fastq reads_2.fastq

# 查看生成的 fastq 数据
$ head -8 reads_1.fastq

gi|110640213|ref|NC_008253.1|_3151106_3151623_4:0:0_5:1:0_0/1
AACATAAGTGGTATTAATTCCCCAAGATTCAAGATTACGAATAGTATTATCCGCAAAAATATCATCACCTACTTTCGTCAGCATCAGGACTTTTGAATTCAATTTAGCCGCCGCCACCGCTTGATTAGCACCTTTGCCACCACATCCGATTTTGAAGGCAGGTGCTTCCAGAGTTTCTCCTTCTTTAGGCATCTGATAAGTGTAAGTAATGAGATCCACCATATTGGAACCAATAAGTGCAATGTCCATT
+
2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
@gi|110640213|ref|NC_008253.1|_2429297_2429873_8:0:0_7:0:0_1/1
ACGGTATCACCATGATTGCCCGTTCCGTCAACAGCATGGGGCTGGTCATTATAGGCGGTGGATCGCTTGAAGAAGCGTTAACTGAACTGGAAACCGGACGCGGCGACGCGGTGGTGGTGCTGGAAAACGAACTGCATCGTCACGCTTGCGCTACCCGCGTGAATGCTGCGCTGGCTAAAGCGCCGCTGGTGATTGTGGTTGACCATCAACGCACAGCGATTATGGAAAACGCTCATCTGGTACTATCCGC
+
2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
```
